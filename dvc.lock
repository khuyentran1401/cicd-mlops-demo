schema: '2.0'
stages:
  process:
    cmd: python src/process_data.py
    deps:
    - path: data/raw
      md5: 3ab2fa89af88fa75de21542ec710c4ba.dir
      size: 222379
      nfiles: 2
    - path: src/process_data.py
      md5: 9854ddc66604e1e1d8069586ac68b561
      size: 2817
    params:
      params.yaml:
        data:
          raw: data/raw/marketing_campaign.csv
          scaled: data/intermediate/scaled_data.pkl
          pca: data/intermediate/pca_data.pkl
          final: data/final/segmented_data.pkl
        process:
          name: process_1
          keep_columns:
          - Income
          - Recency
          - NumWebVisitsMonth
          - AcceptedCmp3
          - AcceptedCmp4
          - AcceptedCmp5
          - AcceptedCmp1
          - AcceptedCmp2
          - Complain
          - Response
          - age
          - total_purchases
          - enrollment_years
          - family_size
          remove_outliers_threshold:
            age: 90
            Income: 600000
          encode:
            family_size:
              Married: 2
              Together: 2
              Absurd: 1
              Widow: 1
              YOLO: 1
              Divorced: 1
              Single: 1
              Alone: 1
    outs:
    - path: data/intermediate/scaled_data.pkl
      md5: 61303ec84520707e3cb1e821fe2a4519
      size: 248630
    - path: scaler
      md5: 2106afeb9407efe5b5087e35f80b82ba.dir
      size: 1495
      nfiles: 1
  train:
    cmd: python src/segment.py
    deps:
    - path: data/intermediate/scaled_data.pkl
      md5: 61303ec84520707e3cb1e821fe2a4519
      size: 248630
    - path: src/segment.py
      md5: 28c1e90ba2af4c6fd8cad962bab234e4
      size: 2146
    params:
      params.yaml:
        data:
          raw: data/raw/marketing_campaign.csv
          scaled: data/intermediate/scaled_data.pkl
          pca: data/intermediate/pca_data.pkl
          final: data/final/segmented_data.pkl
        model: model/kmeans.pkl
        pca:
          n_components: 3
          columns:
          - col1
          - col2
          - col3
        scaler: scaler/standard_scaler.pkl
        segment:
          algorithm: KMeans
          args:
            n_init: auto
      dvclive/params.yaml:
        k: 2
    outs:
    - path: data/intermediate/pca_data.pkl
      md5: b1fe8e053ebf6bdbcd2d3ef22a811b3f
      size: 53793
    - path: image/elbow.png
      md5: 7a8cd96e3fd6351273eb5223d49532ac
      size: 64654
    - path: model/kmeans.pkl
      md5: eee8e3ca8f89af1b29314ef1fce40123
      size: 10007
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/intermediate
      md5: ecaf0b06bde83a955a63944f737e2dd8.dir
      size: 302423
      nfiles: 2
    - path: scaler
      md5: 2106afeb9407efe5b5087e35f80b82ba.dir
      size: 1495
      nfiles: 1
    - path: src/evaluate.py
      md5: 1ace45e4d3de090ae6df2abb655dbc7f
      size: 2439
    params:
      params.yaml:
        data:
          raw: data/raw/marketing_campaign.csv
          scaled: data/intermediate/scaled_data.pkl
          pca: data/intermediate/pca_data.pkl
          final: data/final/segmented_data.pkl
        image:
          elbow: image/elbow.png
          clusters: image/cluster.png
        model: model/kmeans.pkl
        scaler: scaler/standard_scaler.pkl
    outs:
    - path: data/final
      md5: c36abbf80ce282dd5c93e5800027f434.dir
      size: 257571
      nfiles: 1
    - path: dvclive/metrics.json
      md5: a865f5f281b1fd0ae4c9014b876a625f
      size: 47
    - path: image/cluster.png
      md5: 19eb46b7811d86535743c02850cec3ed
      size: 142654
